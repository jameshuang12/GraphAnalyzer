from datetime import datetime
import stock_class
import confirm_input

def main():

    user_data = confirm_input.userInput()

    clientData = stock_class.Stock(user_data[0], user_data[1], user_data[2])
    #print(clientData[days])
    "\n"

    while True:
        investment(clientData)
        while True:
            answer = str(input('Would you like to run again? (y/n): '))
            if answer in ('y', 'n'):
                break
            print("invalid input.")
        if answer == 'y':
            continue
        else:
            print("Goodbye")
            break


def percentageChange(clientData):
    """ Get the percentage change of the two dates given by the user.

    :param clientData: All the data needed from the given dates
    :return: the percent change between the first to the second
    """
    print('For the first date')
    data1 = askUserForData(clientData)
    print('For the second date')
    data2 = askUserForData(clientData)

    first_call = 'first_' + str(data1)
    sec_call = 'sec_' + str(data2)

    change = int(((getattr(locals()['clientData'], sec_call)) / 
                  (getattr(locals()['clientData'], first_call))) * 100)

    if change < 100:
        print('The percentage change had a decline of ' + str(change) + '%')
    else:
        print('The percentage change had a growth of ' + str(change) + '%')

    return change


def askUserForData(clientData):
    """ Ask the user for the specific data they want to provided by the stock market

    :param yourmom: All the data needed from the given dates
    :return: the data the user wants to use
    """
    print('Please choose from the options below you would like to use')
    print('1. open, 2. high, 3. low')
    data = str(input('Enter the data here: '))

    while data != ('high') and data != ('open') and data != ('low'):
        data = str(input('Incorrect input, options are open, high ,and low: '))

    return data


def investment(clientData):
    """ Calcualates the investment amount for the user

    :param clientData: All the data needed from the given dates
    :return: the amount gained or lost
    """

    while True:
        amount = str(input('Enter the amount you would like to invest: $'))
        if not amount.isdigit():
            print('Invalid input (requires numeric amount)')
            continue
        else:
            amount = int(amount)
            break

    investmentAmount = int(amount * (percentageChange(clientData) / 100))


    if investmentAmount < amount:
        total = int(amount - investmentAmount)
        print('If you invested on '+ str(clientData.day1) + ' with the amount of $' + str(amount) + ' ,then you'
              " would've lost $" + str(total) + " if you withdraw on " + str(clientData.day2) + ".")
    else:
        total = investmentAmount - amount
        print('If you invested on ' + str(clientData.day1) + ' with the amount of $' + str(amount) + ' ,then you'
             " would've gained $" + str(total) + " if you withdraw on " + str(clientData.day2) + ".")


if __name__ == '__main__':
    main()
